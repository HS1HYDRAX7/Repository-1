local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/WindUI.lua"))()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local LocalPlayer = Players.LocalPlayer
local DEFAULT_GRAVITY = workspace.Gravity

local Window = WindUI:CreateWindow({
	Title = "Nexus Hub v2.2.0.1",
	Subtitle = "by Hydra",
	Icon = "rocket",
	Theme = "Dark",
	Border = true,
	ToggleKey = Enum.KeyCode.RightShift
})

local PlayerSection = Window:Section({ Title = "Player", Icon = "user", Border = true })
local ForsakenSection = Window:Section({ Title = "Forsaken", Icon = "skull", Border = true })
local OthersSection = Window:Section({ Title = "Others", Icon = "layers", Border = true })
local InfoSection = Window:Section({ Title = "Info", Icon = "info", Border = true })

local PlayerTab = PlayerSection:Tab({ Title = "Movement" })
local ForsakenTab = ForsakenSection:Tab({ Title = "Main" })
local OthersTab = OthersSection:Tab({ Title = "Utilities" })
local InfoTab = InfoSection:Tab({ Title = "Credits" })

local playerEnabled=false
local noclipEnabled=false
local infJump=false
local cframeSpeed=1
local gravity=196.2
local noclipConn
local originalCollisions={}

local function applyNoclip(char)
	if noclipConn then noclipConn:Disconnect() end
	if not char then return end
	originalCollisions={}
	for _,p in ipairs(char:GetDescendants()) do
		if p:IsA("BasePart") then
			originalCollisions[p]=p.CanCollide
			p.CanCollide=false
		end
	end
	noclipConn=RunService.Stepped:Connect(function()
		if not noclipEnabled or not char.Parent then return end
		for _,p in ipairs(char:GetDescendants()) do
			if p:IsA("BasePart") then p.CanCollide=false end
		end
	end)
end

local function removeNoclip()
	if noclipConn then noclipConn:Disconnect() noclipConn=nil end
	for p,v in pairs(originalCollisions) do
		if p and p.Parent then p.CanCollide=v end
	end
	originalCollisions={}
end

LocalPlayer.CharacterAdded:Connect(function(c)
	if noclipEnabled then task.wait(0.25) applyNoclip(c) end
end)

PlayerTab:Toggle({
	Title="Enable",
	Value=false,
	Callback=function(v)
		playerEnabled=v
		if not v then workspace.Gravity=DEFAULT_GRAVITY end
	end
})

PlayerTab:Slider({
	Title="CFrame Speed",
	Step=1,
	Value={Min=1,Max=70,Default=1},
	Callback=function(v) cframeSpeed=v end
})

PlayerTab:Slider({
	Title="Gravity",
	Step=1,
	Value={Min=0,Max=300,Default=196},
	Callback=function(v) gravity=v end
})

PlayerTab:Toggle({
	Title="Noclip",
	Value=false,
	Callback=function(v)
		noclipEnabled=v
		if v then applyNoclip(LocalPlayer.Character) else removeNoclip() end
	end
})

PlayerTab:Toggle({
	Title="Infinite Jump",
	Value=false,
	Callback=function(v) infJump=v end
})

UserInputService.JumpRequest:Connect(function()
	if infJump and LocalPlayer.Character then
		local hum=LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
		if hum then hum:ChangeState(Enum.HumanoidStateType.Jumping) end
	end
end)

RunService.Heartbeat:Connect(function()
	if not playerEnabled then return end
	local char=LocalPlayer.Character
	local hrp=char and char:FindFirstChild("HumanoidRootPart")
	local hum=char and char:FindFirstChildOfClass("Humanoid")
	if not hrp or not hum then return end
	workspace.Gravity=gravity
	local dir=hum.MoveDirection
	if dir.Magnitude>0 then
		hrp.CFrame=hrp.CFrame+(dir*(cframeSpeed*0.08))
	end
end)

local espKiller=false
local espSurvivor=false
local espGen=false
local autoGen=false
local genDelay=5
local genBusy=false
local infStamina=false
local staminaConn
local staminaModule

local function clearESP()
	for _,o in ipairs(workspace:GetDescendants()) do
		if (o:IsA("Highlight") or o:IsA("BillboardGui")) and string.find(o.Name,"Nexus") then
			o:Destroy()
		end
	end
end

local function addHL(inst,color)
	local h=inst:FindFirstChild("NexusHL")
	if not h then
		h=Instance.new("Highlight")
		h.Name="NexusHL"
		h.Adornee=inst
		h.DepthMode=Enum.HighlightDepthMode.AlwaysOnTop
		h.Parent=inst
	end
	h.FillColor=color
	h.OutlineColor=color
	h.FillTransparency=0.45
end

local function updatePlayerESP()
	local wp=workspace:FindFirstChild("Players")
	if not wp then return end
	for _,plr in ipairs(Players:GetPlayers()) do
		if plr~=LocalPlayer and plr.Character then
			if espKiller and plr.Character.Parent==wp:FindFirstChild("Killers") then
				addHL(plr.Character,Color3.fromRGB(255,0,0))
			elseif espSurvivor and plr.Character.Parent==wp:FindFirstChild("Survivors") then
				addHL(plr.Character,Color3.fromRGB(0,255,0))
			end
		end
	end
end

ForsakenTab:Toggle({
	Title="Infinite Stamina",
	Value=false,
	Callback=function(v)
		infStamina=v
		if staminaConn then staminaConn:Disconnect() staminaConn=nil end
		if v then
			local sprint=ReplicatedStorage:WaitForChild("Systems"):WaitForChild("Character"):WaitForChild("Game"):WaitForChild("Sprinting")
			staminaModule=require(sprint)
			staminaConn=RunService.Heartbeat:Connect(function()
				staminaModule.Stamina=staminaModule.MaxStamina or 999
			end)
		end
	end
})

ForsakenTab:Toggle({ Title="ESP Killers", Value=false, Callback=function(v) espKiller=v if not v then clearESP() end end })
ForsakenTab:Toggle({ Title="ESP Survivors", Value=false, Callback=function(v) espSurvivor=v if not v then clearESP() end end })
ForsakenTab:Toggle({ Title="ESP Generators", Value=false, Callback=function(v) espGen=v if not v then clearESP() end end })
ForsakenTab:Toggle({ Title="Auto Generator", Value=false, Callback=function(v) autoGen=v end })

ForsakenTab:Slider({
	Title="Gen Speed",
	Step=1,
	Value={Min=1,Max=10,Default=5},
	Callback=function(v) genDelay=v end
})

task.spawn(function()
	while task.wait(0.5) do
		updatePlayerESP()
	end
end)

task.spawn(function()
	while task.wait(1) do
		if autoGen and not genBusy then
			genBusy=true
			local map=workspace:FindFirstChild("Map")
			local ing=map and map:FindFirstChild("Ingame")
			local m=ing and ing:FindFirstChild("Map")
			if m then
				for _,g in ipairs(m:GetChildren()) do
					if g.Name=="Generator" and g:FindFirstChild("Remotes") then
						pcall(function() g.Remotes.RE:FireServer() end)
						task.wait(genDelay)
					end
				end
			end
			genBusy=false
		end
	end
end)

OthersTab:Button({
	Title="Infinite Yield With AI",
	Justify="Center",
	Callback=function()
		loadstring(game:HttpGet("https://raw.githubusercontent.com/BokX1/InfiniteYieldWithAI/refs/heads/main/InfiniteYieldWithAI.Lua"))()
	end
})

local clockLabel = InfoTab:Paragraph({ Title="Clock", Desc="--:--:--" })
task.spawn(function()
	while task.wait(1) do
		clockLabel:Set("Desc",""..os.date("%H:%M:%S"))
	end
end)

InfoTab:Paragraph({ Title="Creators", Desc="Hydra (Owner)" })
